(function(d,e,c){var g=function(a,b){return c(c.extend(e.createElement(a),b))};c.suitUp={controls:"italic bold | formatblock#<h1> formatblock#<h2> formatblock#<h3> formatblock#<p> | fontname link".split(" "),commands:{createlink:function(a){a(d.prompt("URL:",""))},fontname:{Arial:"arial",Times:"times"}},custom:{link:function(a,b){return g("a",{className:"suitup-control",href:"#"}).attr({"data-command":"createlink"}).on("click",function(){c.suitUp.hasSelectedNodeParent("a")?e.execCommand("unlink",
!1,null):e.execCommand("createlink",!1,d.prompt("URL:",""));a.value=c(b).find(".suitup-editor").html()})}},getSelection:function(){var a;if(d.getSelection)try{a=d.getSelection().getRangeAt(0)}catch(b){}else e.selection&&(a=e.selection.createRange());return a},restoreSelection:function(a){var b;a&&(d.getSelection?(b=d.getSelection(),0<b.rangeCount&&b.removeAllRanges(),b.addRange(a)):e.createRange?d.getSelection().addRange(a):e.selection&&a.select())},getSelectedNode:function(){if(e.selection)return e.selection.createRange().parentElement();
var a=d.getSelection();if(0<a.rangeCount)return a.getRangeAt(0).endContainer},hasSelectedNodeParent:function(a){var b=this.getSelectedNode(),c=!1;for(a=a.toUpperCase();b&&"BODY"!==b.tagName;){if(b.tagName===a){c=!0;break}b=b.parentNode}return c}};c.fn.suitUp=function(a){var b=c.suitUp,d,p,w=c.suitUp.commands,u=c.suitUp.custom,x=b.getSelection,y=b.restoreSelection;a=a||c.suitUp.controls;a=a instanceof Array?a:Array.prototype.slice.call(arguments);return this.each(function(){for(var b=this,l=c(this).hide(),
q,r,j,h,v,m=g("div",{className:"suitup"}).width(l.width()),k=g("div",{className:"suitup-controls"}).appendTo(m),t=g("div",{className:"suitup-editor",contentEditable:!0}).keyup(function(){n();s()}).focus(function(){p=this}).mouseup(function(){s()}).html(b.value).height(l.height()).appendTo(m),n=function(){b.value=t.html()},s=function(){q=q||c("a.suitup-control",k);q.removeClass("active").each(function(){var a=c(this),b=a.data("command"),d=a.data("value");try{d=d?d.replace("<","").replace(">",""):d,
e.queryCommandValue(b)===(d||"true")&&a.addClass("active")}catch(f){}try{e.queryCommandState(b)&&a.addClass("active")}catch(g){}});r=r||c("select.suitup-control",k);r.each(function(){var a=c(this),b=a.data("command"),d=e.queryCommandValue(b),a=a.children("option").filter(function(){return d&&this.value.toLowerCase()===d.toLowerCase()});a.length&&(this.value=a.val())})},l=0,f=a[0];l<a.length;f=a[++l])if(j=f.split("#"),f=j[0],h=j[1],"|"===f)g("span",{className:"suitup-separator"}).appendTo(k);else if(f in
u)u[f](b,m[0]).appendTo(k);else if(h=h||w[f]||null,j=typeof h,h&&"object"===j)v=g("select",{className:"suitup-control"}).attr("data-command",f).appendTo(k).on("change",{command:f},function(a){e.execCommand(a.data.command,null,this.value);n()}),c.each(h,function(a,b){g("option",{value:b}).html(a).appendTo(v)});else g("a",{href:"#",className:"suitup-control"}).attr({"data-command":f,"data-value":"function"===j?"_DYNAMIC_":h}).appendTo(k).on("click",{command:f,value:h,typeofValue:j},function(a){var b=
a.data.command,c=a.data.value;a=a.data.typeofValue;(p!==t[0]||!d)&&t.focus();"function"===a?(d=x(),c(function(a){p.focus();y(d);e.execCommand(b,null,a);n()})):(e.execCommand(b,null,c),n(),s());return!1});m.insertBefore(b)})}})(window,document,jQuery);